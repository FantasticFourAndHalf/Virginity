{% extends 'index.html' %}


{% block body %}

<script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js" xmlns="http://www.w3.org/1999/html"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript">

		$(document).ready(function() {
    		var accordion_head = $('.accordion > li > a'),
				accordion_body = $('.accordion li > .sub-menu');

			accordion_head.on('click', function(event) {
				// Disable header links

				event.preventDefault();

				if ($(this).attr('class') != 'active'){
					accordion_body.slideUp('normal');
					$(this).next().stop(true,true).slideToggle('normal');
					accordion_head.removeClass('active');
					$(this).addClass('active');
					getMenuItems(this);
				} else {
					$(this).next().stop(true,true).slideToggle('normal');
				}

			});

		});

</script>
<script>
    function createMenuItems(MenuItems, submenu) {
        var subMenu = submenu.parentElement.children[1];
        subMenu.innerHTML = "";

        for( var i = 0; i < MenuItems.length; i++) {
           var obj = (JSON.parse(MenuItems[0].value))[0];
           var li = document.createElement("li");
           var item = document.createElement("a");
           var itemPrice = document.createElement("span");
           itemPrice.innerHTML = obj.fields.price+" грн.";
           item.innerHTML = obj.fields.name;
           item.appendChild(itemPrice);
           li.appendChild(item);
           subMenu.appendChild(li);
        }
    }


    function getMenuItems(item) {
        var menuCategory = item.id;
        if (menuCategory) {
            $.get( menuCategory, function( data ) {
                createMenuItems(data.dishes,item);
            });
         }
    }
</script>

<section class="probootstrap-section probootstrap-bg-white">
    <input type="text" class="search" placeholder="Search">
    <button class="sort" data-sort="name">Name</button>
    <button class="sort" data-sort="time">Time(ms)</button>
    <button class="sort" data-sort="proteins">Proteins</button>
    <button class="sort" data-sort="fats">Fats</button>
    <button class="sort" data-sort="carbohydrates">Carbohydrates</button>
    <button class="sort" data-sort="calories">Calories</button>
    <button class="sort" data-sort="price">Price($)</button>
    <div class="container">
        <div id="wrapper-250">
            <ul class="accordion">

                <li id="one" class="files">

                    <a href="#one" id="1">Аперетиви<span>495</span></a>

                    <ul class="sub-menu">

                    </ul>

                </li>

                <li id="two" class="mail">

                    <a href="#two" id="2">Салати<span>26</span></a>

                    <ul class="sub-menu">

                    </ul>

                </li>

                <li id="three" class="cloud">

                    <a href="#three" id="4">Перші страви<span>58</span></a>

                    <ul class="sub-menu">

                    </ul>

                </li>

                <li id="four" class="sign">

                    <a href="#four" id="5">Основні блюда</a>

                    <ul class="sub-menu">

                    </ul>

                </li>

            </ul>
        </div>
    </div>
  </section>


<script type="text/javascript">
var options = {
  valueNames: [ 'name', 'time', 'proteins', 'fats', 'carbohydrates', 'calories', 'price' ]
};

var userList = new List('menu', options);
</script>

<script type="text/javascript">
    var order = [];

    function sendToServer() {
        var data = 'Order = ' + JSON.stringify(order, '', 1);
        alert(data);
        $.ajax({
            url:'',
            type:'POST',
            cache:false,
            data: data,
            success:function() {
            }
        });
    }

function addToOrder(){
var dish = event.currentTarget.id;
order.push(dish);
  var snackbarContainer = document.querySelector('#add-to-basket');
  handler = function(event) {
    data = {
        message: dish +' has just removed from order.',
        timeout: 2000,
        actionHandler: ok,
        actionText: 'Ok'
      };
      order.pop();
      snackbarContainer.MaterialSnackbar.showSnackbar(data);
      sendToBack();

  };
  ok = function(event){};

        var data = {
            message: dish + ' has just added to the order.',
            timeout: 2000,
            actionHandler: handler,
            actionText: 'Undo'
        };
    snackbarContainer.MaterialSnackbar.showSnackbar(data);
    sendToServer()
}
</script>
{% endblock %}
